<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<link rel="stylesheet" type="text/css" href="css/buttons.css"/>
	<link rel="stylesheet" type="text/css" href="../css/bootstrap-3.2.0-dist/css/bootstrap.min.css"/>
	<link rel="stylesheet" type="text/css" href="css/styles/default.css"/>	
	<link rel="stylesheet" type="text/css" href="css/api.css"/>	

	<script type="text/javascript" src="js/jquery-1.11.1.js"></script>
	<script type="text/javascript" src="js/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

	<title>WFS GetGmlObject服务接口</title>
</head>

<body>
	<div style="padding:0px;height:100%;background:#fff;">
		<div class="servcie_request">
			<div id="request_bar" class="service_bar">
				<!-- <span>请求参数：</span> -->
				<!-- <input type="button" value="发送" onclick="javascript:onPost();" style="float:right"> -->
				<a href="javascript:void(0);" class="button button-primary button-rounded button-small">请求参数</a>
			</div>
			<div id="request_parameters">
				<div>
					<table>
						<tr>
							<td class="request_column"><span>请求地址</span></td>
							<td><input type="text" value='http://127.0.0.1/ows/user1/mgr' name='service_url'></td>
						</tr>
						<tr>
							<td class="request_column"><span>请求文档</span></td>
							<td><textarea id="data" style="margin:0px 0px 10px 10px;width:95%;height:350px;">
<CreateDataSet 
	service="dbs"
	version="1.0.0"
	sourceName="db1"
	dataSetName="table_2">
	<Fields>
		<Field>
			<Name>ID</Name>
			<Type>Int</Type>
			<DefaultValue>0</DefaultValue>
		</Field>
		<Field>
			<Name>Name</Name>
			<Type>String</Type>
			<Length>32</Length>
			<Nullable>true</Nullable>
			<DefaultValue>china</DefaultValue>
		</Field>
		<Field>
			<Name>shape</Name>
			<Type>Geometry</Type>
			<Nullable>true</Nullable>
			<GeometryDef>
				<Type>Point</Type>
				<SRID>4326</SRID>
				<Extent>
					<XMin>-180.0</XMin>
					<XMax>180.0</XMax>
					<YMin>-90.0</YMin>
					<YMax>90.0</YMax>
				</Extent>
			</GeometryDef>
		</Field>
	</Fields>
</CreateDataSet>
							</textarea></td>
						</tr>
					</table>
				</div>
			</div>
		</div>
		<div class="servcie_response" class="service_style">
			<div id="response_bar" class="service_bar">
				<!-- <span>返回结果：</span> -->
				<a href="javascript:void(0);" class="button button-primary button-rounded button-small" onclick="javascript:onPost();">发送请求</a>
			</div>
			<div id="response_container">
			</div>
		</div>
	</div>
</body>

<script type="text/javascript">
	var request_panel_height = 0;
	$().ready(function(){
		request_panel_height = $("#request_parameters").height();

		$("#request_bar").click(function(){
			var request_panel = $("#request_parameters");
			if($("#request_parameters").height()==0)
			{
				request_panel.css("height", request_panel_height.toString() + "px");
			}
			else
			{
				request_panel.css("height","0px");
			}
		})
	})

	function onPost(){
		var url = $("#request_parameters input[name='service_url']").val();
		var data = $("#data").val();
/*		var params = "";
		$("#request_parameters input").each(function(){
			var name = $(this).attr("name");
			var value= $(this).attr("value");
			if(name != 'service_url'){
				if(params.length > 0){
					params += "&";
				}
				params += name + "=" + value;
			}
		})*/
		$.ajax({
			type	:"post",
			url		: url,
			// data	: encodeURI(params),
			// contentType: "application/xml",
			contentType: "text/xml",
			data	: data,
			dataType: "text",
			async	: true,
			beforeSend: function(XMLHttpRequest){
			},
			success	: function(xml, textStatus){
				alert(xml);
			},
			complete: function(XMLHttpRequest, textStatus){
			},
			error	: function(){
			}
		});	
/*		$.ajax({
			type	:"get",
			url		: url,
			 data	: encodeURI(params),
			// contentType: "application/xml",
			contentType: "text/xml",
			dataType: "text",
			async	: true,
			beforeSend: function(XMLHttpRequest){
			},
			success	: function(xml, textStatus){
				var text = "<textarea style='width:100%;height:100%'>"
						 + xml
						 + "</textarea>";
				document.getElementById('response_container').innerHTML = text;
			},
			complete: function(XMLHttpRequest, textStatus){
			},
			error	: function(){
			}
		});	*/
	}
</script>