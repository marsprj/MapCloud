<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<link rel="stylesheet" type="text/css" href="css/buttons.css"/>
	<link rel="stylesheet" type="text/css" href="../css/bootstrap-3.2.0-dist/css/bootstrap.min.css"/>

	<link rel="stylesheet" type="text/css" href="css/mc-user.css"/>
	<link rel="stylesheet" type="text/css" href="css/mc-user-data.css"/>

	<script type="text/javascript" src="../js/3rd/jquery-1.11.1.js"></script>
	<script type="text/javascript" src="js/mc-user-catalog.js"></script>
	<script type="text/javascript" src="js/mc-user-fs.js"></script>	
	
	<title>数据:文件系统</title>
</head>
	
<body>
	<div id="title_wrapper">
		<div class="title_box">数据:文件系统</div>
		
	</div>
	<div id="main_wrapper">
		<!-- FileSystem Panel -->
		<div id="data_catalog_panel">
			<div class="data_title_bar">
				<div class="data_title_icon"></div>
				<div>数据目录</div>
			</div>
		</div>
		<div id="data_main_panel">
			<div class="data_title_bar">
				<a href="javascript:void(0)">数据目录</a>
				<a href="javascript:void(0)">数据上传</a>
				<a href="javascript:void(0)">数据删除</a>
			</div>
		</div>
	</div>
</body>

<script type="text/javascript">
	var editor = null;
	$().ready(function(){

	});

	window.onresize = function(){
		changeEditorSize();
	};

	function onGet(){
		var url = $("#request_parameters input[name='service_url']").val();
		var params = "";
		$("#request_parameters input").each(function(){
			var name = $(this).attr("name");
			var value = $(this).val();
			if(name != 'service_url'){
				if(params.length > 0){
					params += "&";
				}
				params += name + "=" + value;
			}
		})
		$.ajax({
			type	:"get",
			url		: url,
			 data	: encodeURI(params),
			contentType: "text/xml",
			dataType: "text",
			async	: true,
			beforeSend: function(XMLHttpRequest){
			},
			success	: function(xml, textStatus){
				document.getElementById('text_area').innerHTML = xml;
				
				if(editor == null){
					editor = CodeMirror.fromTextArea(document.getElementById("text_area"), {
				        mode: "text/html",
				        lineNumbers: true,
				         gutter: true,
	   					 lineWrapping: true
				    });
			    }else{
			    	editor.setValue(xml);
			    }
				var height = $("#response_container").height();
				var width = $("#response_container").width();
				editor.setSize(width,height);
			},
			complete: function(XMLHttpRequest, textStatus){
			},
			error	: function(){
			}
		});	
	}


	function changeEditorSize(){
		var requestHeight = $(".servcie_request").height().toString();
		var nameHeight = $(".service_name").height().toString();
		var height = parseInt(requestHeight) + parseInt(nameHeight);
		var responseHeight = "calc(100% - " + height + "px)";
		$(".servcie_response").css("height",responseHeight);
		if(editor != null){
			var height = $("#response_container").height();
			var width = $("#response_container").width();
			editor.setSize(width,height);
			editor.refresh();
		}
	}
</script>